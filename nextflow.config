includeConfig "${projectDir}/conf/base.config"
params {
    sample_sheet = null
    reference = null
    reference_fai = null
    regions_bed = null
    nfl_pred_model = null
    outdir = null
}

profiles {
    hpc {
        process {
            executor = 'slurm'
            queue = 'mpcs.p'
            cpus = { 2 * task.attempt }
            memory = { 16.GB * task.attempt }
            time = { 7.d * task.attempt }
            withName: 'VARIANT_CALL|PREDICT_METHYLATION' {
                queue = 'mpcs.p'
                cpus = { 16 * task.attempt }
                memory = { 64.GB * task.attempt }
                time = { 7.d * task.attempt }
            }
            withName: 'EXTRACT_REGION|GET_CG_LOCI|MERGE_METHYLATION' {
                queue = 'mpcs.p'
                cpus = { 16 * task.attempt }
                memory = { 48.GB * task.attempt }
                time = { 7.d * task.attempt }
            }
        }
        workDir = "${System.getenv('WORK')}/ont-methylation-prediction_work"
        singularity.enabled = true
        singularity.autoMounts = true
        singularity.cacheDir = "${projectDir}/container"
        singularity.pullTimeout = '1h'
        docker.enabled = false
        apptainer.enabled = false
    }
    docker {
        docker.enabled = true
        docker.runOptions = '-u $(id -u):$(id -g)'
        singularity.enabled = false
        apptainer.enabled = false
    }
    singularity {
        singularity.enabled = true
        singularity.autoMounts = true
        singularity.cacheDir = "${projectDir}/container"
        docker.enabled = false
        apptainer.enabled = false
    }
    apptainer {
        apptainer.enabled = true
        apptainer.autoMounts = true
        apptainer.cacheDir = "${projectDir}/container"
        docker.enabled = false
        singularity.enabled = false
    }
}
